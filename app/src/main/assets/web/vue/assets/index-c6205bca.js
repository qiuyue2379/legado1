import{o as l,c as y,r as we,a as oe,b as ne,d as v,e as h,w as u,f as _,u as i,l as z,g as m,F as $,E as xe,h as ae,p as Be,i as Ue,j as ue,k as R,s as re,m as ee,n as K,q as de,t as Ee,v as Ne,x as se,y as A,z as pe,A as Q,B,C as X,D as he,G as Ve,H as Te,I as Ie,J as ge,K as $e,L as T,M as Le,N as me,O as _e,P as Re,Q as M,R as Oe,S as Pe,T as De,U as Je,V as Ae,W as Ke,X as je,Y as He,Z as Fe,_ as qe,$ as ze}from"./vendor-ea0dcfac.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const Me="modulepreload",We=function(e,t){return new URL(e,t).href},ie={},te=function(t,n,s){if(!n||n.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=We(r,s),r in ie)return;ie[r]=!0;const p=r.endsWith(".css"),k=p?'[rel="stylesheet"]':"";if(!!s)for(let C=o.length-1;C>=0;C--){const w=o[C];if(w.href===r&&(!p||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${k}`))return;const S=document.createElement("link");if(S.rel=p?"stylesheet":Me,p||(S.as="script",S.crossOrigin=""),S.href=r,document.head.appendChild(S),p)return new Promise((C,w)=>{S.addEventListener("load",C),S.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},H=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},Ge={};function Qe(e,t){const n=we("router-view");return l(),y(n)}const Xe=H(Ge,[["render",Qe]]),Se=[{path:"/",name:"shelf",component:()=>te(()=>import("./BookShelf-01102f6c.js"),["./BookShelf-01102f6c.js","./vendor-ea0dcfac.js","./vendor-a24e7142.css","./el-loading-15d78e2b.js","./el-loading-d0f2d079.css","./BookShelf-1436f5ed.css"],import.meta.url)},{path:"/chapter",name:"chapter",component:()=>te(()=>import("./BookChapter-5d963ac2.js"),["./BookChapter-5d963ac2.js","./vendor-ea0dcfac.js","./vendor-a24e7142.css","./el-loading-15d78e2b.js","./el-loading-d0f2d079.css","./BookChapter-3e045df4.css"],import.meta.url)}];oe({history:ne(),routes:Se});const I=e=>(Be("data-v-aee57c78"),e=e(),Ue(),e),Ye=I(()=>m("br",null,null,-1)),Ze=I(()=>m("br",null,null,-1)),et=I(()=>m("br",null,null,-1)),tt=I(()=>m("br",null,null,-1)),ot=I(()=>m("br",null,null,-1)),nt={style:{"margin-top":"20px"}},rt=I(()=>m("code",null,"^$()[]{}.?+*|",-1)),st=I(()=>m("br",null,null,-1)),it=I(()=>m("code",null,"(?s)",-1)),lt=I(()=>m("br",null,null,-1)),ct=I(()=>m("code",null,"(?m)",-1)),at=I(()=>m("br",null,null,-1)),ut=I(()=>m("code",null,"(?i)",-1)),dt=I(()=>m("br",null,null,-1)),pt={__name:"SourceHelp",setup(e){return(t,n)=>{const s=xe,o=ae;return l(),v($,null,[h(s,{icon:i(z),href:"https://alanskycn.gitee.io/teachme/",target:"_blank"},{default:u(()=>[_("书源制作教程")]),_:1},8,["icon"]),Ye,h(s,{icon:i(z),href:"https://zhuanlan.zhihu.com/p/29436838",target:"_blank"},{default:u(()=>[_("xpath基础教程")]),_:1},8,["icon"]),Ze,h(s,{icon:i(z),href:"https://zhuanlan.zhihu.com/p/32187820",target:"_blank"},{default:u(()=>[_("xpath高级教程")]),_:1},8,["icon"]),et,h(s,{icon:i(z),href:"https://www.w3cschool.cn/regex_rmjc",target:"_blank"},{default:u(()=>[_("正则表达式教程")]),_:1},8,["icon"]),tt,h(s,{icon:i(z),href:"https://regexr-cn.com/",target:"_blank"},{default:u(()=>[_("正则表达式在线验证工具")]),_:1},8,["icon"]),ot,m("div",nt,[m("span",null,[h(o,null,{default:u(()=>[rt,_(" 这些是Java正则特殊符号,匹配需转义")]),_:1})]),st,m("span",null,[h(o,null,{default:u(()=>[it,_(" 前缀表示跨行解析")]),_:1})]),lt,m("span",null,[h(o,null,{default:u(()=>[ct,_(" 前缀表示逐行匹配")]),_:1})]),at,m("span",null,[h(o,null,{default:u(()=>[ut,_(" 前缀表示忽略大小写")]),_:1})]),dt])],64)}}},ht=H(pt,[["__scopeId","data-v-aee57c78"]]),W=e=>e==null||e.length===0||/^\s+$/.test(e),ye=e=>"bookSourceName"in e,gt=e=>ye(e)?!W(e.bookSourceName)&&!W(e.bookSourceUrl)&&!W(e.bookSourceType):!W(e.sourceName)&&!W(e.sourceName),mt=(e,t)=>{var n,s,o,r,p,k,f,S;return ye(e)?(((n=e.bookSourceName)==null?void 0:n.includes(t))||((s=e.bookSourceUrl)==null?void 0:s.includes(t))||((o=e.bookSourceGroup)==null?void 0:o.includes(t))||((r=e.bookSourceComment)==null?void 0:r.includes(t)))??!1:(((p=e.sourceName)==null?void 0:p.includes(t))||((k=e.sourceUrl)==null?void 0:k.includes(t))||((f=e.sourceGroup)==null?void 0:f.includes(t))||((S=e.sourceComment)==null?void 0:S.includes(t)))??!1},_t={ruleSearch:{},ruleBookInfo:{},ruleToc:{},ruleContent:{},ruleReview:{},ruleExplore:{}},St={},J=/bookSource/i.test(location.href),le=J?_t:St,F=ue("source",{state:()=>({bookSources:[],rssSources:[],errorPushSources:[],currentSource:le,currentTab:localStorage.getItem("tabName")||"editTab",editTabSource:{},isDebuging:!1}),getters:{sources:e=>J?e.bookSources:e.rssSources,currentSourceUrl:e=>J?e.currentSource.bookSourceUrl:e.currentSource.sourceUrl,searchKey:e=>J?e.currentSource.ruleSearch.checkKeyWord||"我的":null},actions:{startDebug(){this.currentTab="editDebug",this.isDebuging=!0},debugFinish(){this.isDebuging=!1},saveSources(e){J?this.bookSources=e:this.rssSources=e},deleteSources(e){let t=J?this.bookSources:this.rssSources;e.forEach(n=>{let s=t.indexOf(n);s>-1&&t.splice(s,1)})},saveCurrentSource(){let e=this.currentSource,t,n;J?(t=this.bookSources,n="bookSourceUrl"):(t=this.rssSources,n="sourceUrl");let s=t.findIndex(o=>o[n]===e[n]);e=JSON.parse(JSON.stringify(e)),s>-1?t.splice(s,1,e):t.push(e)},changeCurrentSource(e){const t=JSON.stringify(e);this.currentSource=JSON.parse(t)},async setPushReturnSources(e){J?this.errorPushSources=this.sources.filter(t=>e.every(n=>n.bookSourceUrl!==t.bookSourceUrl)):this.errorPushSources=this.sources.filter(t=>e.every(n=>n.sourceUrl!==t.sourceUrl))},changeTabName(e){this.currentTab=e,localStorage.setItem("tabName",e)},changeEditTabSource(e){const t=JSON.stringify(e);this.editTabSource=JSON.parse(t)},editHistory(e){let t;if(localStorage.getItem("history"))t=JSON.parse(localStorage.getItem("history")),t.new.push(e),t.new.length>50&&t.new.shift(),t.old.length>50&&t.old.shift(),localStorage.setItem("history",JSON.stringify(t));else{const n={new:[e],old:[]};localStorage.setItem("history",JSON.stringify(n))}},editHistoryUndo(){if(localStorage.getItem("history")){let e=JSON.parse(localStorage.getItem("history"));e.old.push(this.currentSource),e.new.length&&(this.currentSource=e.new.pop()),localStorage.setItem("history",JSON.stringify(e))}},clearAllHistory(){localStorage.setItem("history",JSON.stringify({new:[],old:[]}))},clearEdit(){this.editTabSource={},this.currentSource=le},clearAllSource(){this.bookSources=[],this.rssSources=[]}}});const yt={class:"tool"},ft={__name:"SourceList",setup(e){const t=F(),n=R([]),s=R(""),{sources:o,errorPushSources:r}=re(t),p=ee(()=>/bookSource/.test(window.location.href)),k=d=>{t.changeCurrentSource(d)},f=()=>{t.deleteSources(n.value),n.value=[]},S=()=>{t.clearAllSource(),n.value=[]},C=ee(()=>{let d=s.value;return d===""?o.value:o.value.filter(E=>mt(E,d))}),w=()=>{const d=document.createElement("input");d.type="file",d.accept=".json,.txt",d.addEventListener("change",E=>{const O=E.target.files[0];var N=new FileReader;N.readAsText(O),N.onload=()=>{try{const D=JSON.parse(N.result);t.saveSources(D)}catch{B({message:"上传的源格式错误",type:"error"})}}}),d.click()},x=()=>{const d=document.createElement("a");let E=t.sources,O=p.value?"BookSource":"RssSource";d.download=`${O}_${Date().replace(/.*?\s(\d+)\s(\d+)\s(\d+:\d+:\d+).*/,"$2$1$3").replace(/:/g,"")}.json`;let N=new Blob([JSON.stringify(E,null,4)],{type:"application/json"});d.href=window.URL.createObjectURL(N),d.click()};return(d,E)=>{const O=X,N=he,D=Ve,P=Te;return l(),v($,null,[h(O,{modelValue:i(s),"onUpdate:modelValue":E[0]||(E[0]=V=>K(s)?s.value=V:null),class:"search","prefix-icon":i(de),placeholder:"筛选源"},null,8,["modelValue","prefix-icon"]),m("div",yt,[h(N,{onClick:w,icon:i(Ee)},{default:u(()=>[_(" 打开 ")]),_:1},8,["icon"]),h(N,{disabled:i(n).length===0,onClick:x,icon:i(Ne)},{default:u(()=>[_(" 导出")]),_:1},8,["disabled","icon"]),h(N,{icon:i(se),onClick:f,disabled:i(n).length===0},{default:u(()=>[_("删除")]),_:1},8,["icon","disabled"]),h(N,{type:"danger",icon:i(se),onClick:S,disabled:i(o).length===0},{default:u(()=>[_("清空")]),_:1},8,["icon","disabled"])]),h(P,{id:"source-list",modelValue:i(n),"onUpdate:modelValue":E[1]||(E[1]=V=>K(n)?n.value=V:null)},{default:u(()=>[(l(!0),v($,null,A(i(C),V=>(l(),y(D,{size:"large",border:"",label:V,class:pe({error:i(r).includes(V)}),onClick:c=>k(V),key:V.bookSourceName},{default:u(()=>[_(Q(V.bookSourceName||V.sourceName),1)]),_:2},1032,["label","class","onClick"]))),128))]),_:1},8,["modelValue"])],64)}}},bt=H(ft,[["__scopeId","data-v-b11685a6"]]),kt=1e3,U=Ie.create({baseURL:location.origin,timeout:5*kt}),{hostname:fe,port:be}=new URL(location.href),vt=/source/i.test(location.href),Ct=e=>{throw vt&&B({message:"后端错误，检查网络或者阅读app",type:"error"}),e};U.interceptors.response.use(e=>e,Ct);const wt=()=>U.get("/getReadConfig"),xt=e=>U.post("/saveReadConfig",e),Bt=e=>U.post("/saveBookProgress",e),Ut=()=>U.get("/getBookshelf"),Et=e=>U.get("/getChapterList?url="+encodeURIComponent(e)),Nt=(e,t)=>U.get("/getBookContent?url="+encodeURIComponent(e)+"&index="+t),Vt=(e,t,n)=>{const s=`ws://${fe}:${Number(be)+1}/searchBook`,o=new WebSocket(s);o.onopen=()=>{o.send(`{"key":"${e}"}`)},o.onmessage=({data:r})=>t(r),o.onclose=()=>{n()}},Tt=e=>U.post("/saveBook",e),It=e=>U.post("/deleteBook",e),G=/bookSource/i.test(location.href),$t=()=>G?U.get("getBookSources"):U.get("getRssSources"),Lt=e=>G?U.post("saveBookSource",e):U.post("saveRssSource",e),Rt=e=>G?U.post("saveBookSources",e):U.post("saveRssSources",e),Ot=e=>G?U.post("deleteBookSources",e):U.post("deleteRssSources",e),Pt=(e,t,n,s)=>{const o=`ws://${fe}:${Number(be)+1}/${G?"bookSource":"rssSource"}Debug`,r=new WebSocket(o);r.onopen=()=>{r.send(`{"tag":"${e}", "key":"${t}"}`)},r.onmessage=({data:p})=>n(p),r.onclose=()=>{B({message:"调试已关闭！",type:"info"}),s()}},j={getReadConfig:wt,saveReadConfig:xt,saveBookProcess:Bt,getBookShelf:Ut,getChapterList:Et,getBookContent:Nt,search:Vt,saveBook:Tt,deleteBook:It,getSources:$t,saveSources:Rt,saveSource:Lt,deleteSource:Ot,debug:Pt},Dt={__name:"SourceDebug",setup(e){const t=F(),n=R(""),s=R("");ge(()=>{t.isDebuging&&r()});const o=k=>{let f=document.querySelector("#debug-text");f.scrollTop=f.scrollHeight,n.value+=k+`
`},r=async()=>{n.value="",await j.saveSource(t.currentSource),j.debug(t.currentSourceUrl,s.value||t.searchKey,o,t.debugFinish)},p=ee(()=>/bookSource/.test(window.location.href));return(k,f)=>{const S=X;return l(),v($,null,[i(p)?(l(),y(S,{key:0,id:"debug-key",modelValue:i(s),"onUpdate:modelValue":f[0]||(f[0]=C=>K(s)?s.value=C:null),placeholder:"搜索书名、作者","prefix-icon":i(de),style:{"padding-bottom":"4px"},onKeydown:$e(r,["enter"])},null,8,["modelValue","prefix-icon","onKeydown"])):T("",!0),h(S,{id:"debug-text",modelValue:i(n),"onUpdate:modelValue":f[1]||(f[1]=C=>K(n)?n.value=C:null),type:"textarea",readonly:"",rows:"29",placeholder:"这里用于输出调试信息"},null,8,["modelValue"])],64)}}},io=ue("book",{state:()=>({connectStatus:"正在连接后端服务器……",connectType:"",newConnect:!0,searchBooks:[],shelf:[],catalog:[],readingBook:{index:0,chapterPos:0},popCataVisible:!1,contentLoading:!0,showContent:!1,config:{theme:0,font:0,fontSize:18,readWidth:800,infiniteLoading:!1,customFontName:""},miniInterface:!1,readSettingsVisible:!1}),actions:{setConnectStatus(e){this.connectStatus=e},setConnectType(e){this.connectType=e},setNewConnect(e){this.newConnect=e},addBooks(e){this.shelf=e},setCatalog(e){this.catalog=e},setPopCataVisible(e){this.popCataVisible=e},setContentLoading(e){this.contentLoading=e},setReadingBook(e){this.readingBook=e},setConfig(e){this.config=e},setReadSettingsVisible(e){this.readSettingsVisible=e},setShowContent(e){this.showContent=e},setMiniInterface(e){this.miniInterface=e},async setSearchBooks(e){e.forEach(t=>{this.shelf.find(s=>s.bookUrl==t.bookUrl)===void 0&&this.searchBooks.push(t)})},clearSearchBooks(){this.searchBooks=[]},async saveBookProcess(){var r;if(this.catalog.length==0)return;const{index:e,chapterPos:t,bookName:n,bookAuthor:s}=this.readingBook;let o=(r=this.catalog[e])==null?void 0:r.title;o&&j.saveBookProcess({name:n,author:s,durChapterIndex:e,durChapterPos:t,durChapterTime:new Date().getTime(),durChapterTitle:o})}}}),Jt=Le();const At={__name:"SourceJson",setup(e){const t=F(),n=R(""),s=async o=>{try{t.changeEditTabSource(JSON.parse(o))}catch{B({message:"粘贴的源格式错误",type:"error"})}};return ge(async()=>{let o=t.editTabSource;Object.keys(o).length>0?n.value=JSON.stringify(o,null,4):n.value=""}),(o,r)=>{const p=X;return l(),y(p,{modelValue:i(n),"onUpdate:modelValue":r[0]||(r[0]=k=>K(n)?n.value=k:null),type:"textarea",placeholder:"这里输出序列化的JSON数据,可直接导入'阅读'APP",rows:"30",onChange:s,style:{"margin-bottom":"4px"}},null,8,["modelValue"])}}},Kt={__name:"SourceTabTools",setup(e){const t=F(),{currentTab:n}=re(t),s=R([["editTab","编辑源"],["editDebug","调试源"],["editList","源列表"],["editHelp","帮助信息"]]);return(o,r)=>{const p=At,k=Dt,f=bt,S=ht,C=me,w=_e;return l(),y(w,{modelValue:i(n),"onUpdate:modelValue":r[0]||(r[0]=x=>K(n)?n.value=x:null)},{default:u(()=>[(l(!0),v($,null,A(i(s),(x,d)=>(l(),y(C,{key:x[0],name:x[0],label:x[1]},{default:u(()=>[d==0?(l(),y(p,{key:0})):T("",!0),d==1?(l(),y(k,{key:1})):T("",!0),d==2?(l(),y(f,{key:2})):T("",!0),d==3?(l(),y(S,{key:3})):T("",!0)]),_:2},1032,["name","label"]))),128))]),_:1},8,["modelValue"])}}};const jt={class:"menu flex-column-center"},Ht={class:"hotkeys-header flex-space-between"},Ft=["id"],qt={key:0},zt={class:"hotkeys-settings flex-column-center"},Mt={class:"title"},Wt={class:"hotkeys-item__content"},Gt={key:0},Qt={key:0},Xt={__name:"ToolBar",setup(e){const t=F(),n=()=>{j.getSources().then(({data:c})=>{c.isSuccess?(t.changeTabName("editList"),t.saveSources(c.data),B({message:`成功拉取${c.data.length}条源`,type:"success"})):B({message:c.errorMsg??"后端错误",type:"error"})})},s=()=>{let c=t.sources;if(t.changeTabName("editList"),c.length===0)return B({message:"空空如也",type:"info"});B({message:"正在推送中",type:"info"}),j.saveSources(c).then(({data:a})=>{if(a.isSuccess){let b=a.data;if(Array.isArray(b)){let L="";c.length>b.length&&(L=`
推送失败的源将用红色字体标注!`,t.setPushReturnSources(b)),B({message:`批量推送源到「阅读3.0APP」
共计: ${c.length} 条
成功: ${b.length} 条
失败: ${c.length-b.length} 条${L}`,type:"success"})}}else B({message:`批量推送源失败!
ErrorMsg: ${a.errorMsg}`,type:"error"})})},o=()=>{t.changeTabName("editTab"),t.changeEditTabSource(t.currentSource)},r=()=>{t.changeCurrentSource(t.editTabSource)},p=()=>{t.editHistoryUndo()},k=()=>{t.clearEdit(),B({message:"已清除",type:"success"})},f=()=>{t.clearEdit(),t.clearAllHistory(),B({message:"已清除所有历史记录",type:"success"})},S=()=>{let c=/bookSource/.test(location.href),a=t.currentSource;gt(a)?j.saveSource(a).then(({data:b})=>{b.isSuccess?(B({message:`源《${c?a.bookSourceName:a.sourceName}》已成功保存到「阅读3.0APP」`,type:"success"}),t.saveCurrentSource()):B({message:`源《${c?a.bookSourceName:a.sourceName}》保存失败!
ErrorMsg: ${b.errorMsg}`,type:"error"})}):B({message:"请检查<必填>项是否全部填写",type:"error"})},C=()=>{t.startDebug()},w=R(Array.of({name:"⇈推送源",hotKeys:[],action:s},{name:"⇊拉取源",hotKeys:[],action:n},{name:"⋙生成源",hotKeys:[],action:o},{name:"⋘编辑源",hotKeys:[],action:r},{name:"✗清空表单",hotKeys:[],action:k},{name:"↶撤销操作",hotKeys:[],action:p},{name:"↷重做操作",hotKeys:[],action:f},{name:"⇏调试源",hotKeys:[],action:C},{name:"✓保存源",hotKeys:[],action:S})),x=R(!0),d=R(!1),E=R(-1),O=()=>{d.value=!1};Re(x,c=>{if(!c)return M.unbind("*");M.unbind(),M("*",a=>{a.preventDefault(),d.value&&E.value>-1&&(w.value[E.value].hotKeys=M.getPressedKeyString())})});const N=c=>{d.value=!0,B({message:"按ESC键或者点击空白处结束录入",type:"info"}),w.value[c].hotKeys=[],E.value=c},D=()=>{x.value=!1;const c=[];w.value.forEach(({hotKeys:a,action:b})=>{M(a.join("+"),L=>{L.preventDefault(),b.call(null)}),c.push(a)}),P(c)},P=c=>{localStorage.setItem("legado_web_hotkeys",JSON.stringify(c))},V=()=>{try{const c=JSON.parse(localStorage.getItem("legado_web_hotkeys"));if(!Array.isArray(c)||c.length==0)return;w.value.forEach((a,b)=>a.hotKeys=c[b]),x.value=!1,D()}catch{B({message:"快捷键配置错误",type:"error"}),localStorage.removeItem("legado_web_hotkeys")}};return Oe(()=>{V()}),(c,a)=>{const b=he,L=ae,Y=Je;return l(),v($,null,[m("div",jt,[(l(!0),v($,null,A(i(w),g=>(l(),y(b,{size:"large",key:g.name,onClick:g.action},{default:u(()=>[_(Q(g.name),1)]),_:2},1032,["onClick"]))),128)),h(b,{size:"large",onClick:a[0]||(a[0]=()=>x.value=!0)},{default:u(()=>[_("快捷键")]),_:1})]),h(Y,{modelValue:i(x),"onUpdate:modelValue":a[1]||(a[1]=g=>K(x)?x.value=g:null),"show-close":!1,"before-close":O},{header:u(({titleClass:g,titleId:q})=>[m("div",Ht,[m("div",{id:q,class:pe(g)},[_(" 快捷键设置 "),i(d)?(l(),v("span",qt,[h(L,null,{default:u(()=>[_(" / 录入中 ")]),_:1})])):T("",!0)],10,Ft),h(b,{disabled:i(d),onClick:D,icon:i(Pe)},{default:u(()=>[_("保存")]),_:1},8,["disabled","icon"])])]),default:u(()=>[m("div",zt,[(l(!0),v($,null,A(i(w),(g,q)=>(l(),v("div",{key:g.name,class:"hotkeys-item flex-space-between"},[m("span",Mt,[h(L,null,{default:u(()=>[_(Q(g.name),1)]),_:2},1024)]),m("div",Wt,[(l(!0),v($,null,A(g.hotKeys,(Z,Ce)=>(l(),v("div",{key:Z},[m("kbd",null,Q(Z),1),Ce+1<g.hotKeys.length?(l(),v("span",Gt,[h(L,null,{default:u(()=>[_("+")]),_:1})])):T("",!0)]))),128)),g.hotKeys.length==0?(l(),v("span",Qt,"未设置")):T("",!0)]),h(b,{disabled:i(d),text:"",icon:i(De),onClick:Z=>N(q)},{default:u(()=>[_("编辑")]),_:2},1032,["disabled","icon","onClick"])]))),128))])]),_:1},8,["modelValue"])],64)}}},Yt=H(Xt,[["__scopeId","data-v-ce145888"]]);const Zt={__name:"SourceTabForm",props:["config"],setup(e){const t=e,n=F(),s=Object.values(t.config),{currentSource:o}=re(n);return(r,p)=>{const k=X,f=Ae,S=Ke,C=je,w=He,x=Fe,d=qe,E=me,O=_e;return l(),y(O,{id:"source-edit"},{default:u(()=>[(l(!0),v($,null,A(i(s),({name:N,children:D})=>(l(),y(E,{label:N,key:N},{default:u(()=>[h(d,{"label-position":"right","label-width":"5em"},{default:u(()=>[(l(!0),v($,null,A(D,({type:P,title:V,namespace:c,id:a,array:b,hint:L,required:Y})=>(l(),y(x,{label:V,key:V,required:Y},{default:u(()=>[P=="String"&&typeof c>"u"?(l(),y(k,{key:0,type:"textarea",modelValue:i(o)[a],"onUpdate:modelValue":g=>i(o)[a]=g,placeholder:L,autosize:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):T("",!0),P=="String"&&typeof c<"u"?(l(),y(k,{key:1,type:"textarea",modelValue:i(o)[c][a],"onUpdate:modelValue":g=>i(o)[c][a]=g,placeholder:L,autosize:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):T("",!0),P=="Boolean"?(l(),y(f,{key:2,modelValue:i(o)[a],"onUpdate:modelValue":g=>i(o)[a]=g},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),P=="Number"?(l(),y(S,{key:3,modelValue:i(o)[a],"onUpdate:modelValue":g=>i(o)[a]=g,min:0},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),P=="Array"?(l(),y(w,{key:4,modelValue:i(o)[a],"onUpdate:modelValue":g=>i(o)[a]=g},{default:u(()=>[(l(!0),v($,null,A(b,(g,q)=>(l(),y(C,{value:q,key:g,label:g},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):T("",!0)]),_:2},1032,["label","required"]))),128))]),_:2},1024)]),_:2},1032,["label"]))),128))]),_:1})}}},eo=H(Zt,[["__scopeId","data-v-8c06b92d"]]),to={base:{name:"基础",children:[{title:"源类型",id:"bookSourceType",type:"Array",array:["文本","音频","图片","文件"],required:!0},{title:"源域名",id:"bookSourceUrl",type:"String",hint:"通常填写网站主页,例: https://www.qidian.com",required:!0},{title:"源名称",id:"bookSourceName",type:"String",hint:"会显示在源列表",required:!0},{title:"源分组",id:"bookSourceGroup",type:"String",hint:"描述源的特征信息"},{title:"源注释",id:"bookSourceComment",type:"String",hint:"描述源作者和状态"},{title:"书源变量",id:"variableComment",type:"String",hint:"书源变量说明"},{title:"登录地址",id:"loginUrl",type:"String",hint:"填写网站登录网址,仅在需要登录的源有用"},{title:"登录界面",id:"loginUi",type:"String",hint:"自定义登录界面"},{title:"登录检测",id:"loginCheckJs",type:"String",hint:"登录检测js"},{title:"封面解密",id:"coverDecodeJs",type:"String",hint:"封面解密js"},{title:"并发率",id:"concurrentRate",type:"String",hint:"并发率"},{title:"js库",id:"jsLib",type:"String",hint:"js库"},{title:"请求头",id:"header",type:"String",hint:"客户端标识"},{title:"链接验证",id:"bookUrlPattern",type:"String",hint:"当详情页URL与源URL的域名不一致时有效，用于添加网址"}]},search:{name:"搜索",children:[{title:"搜索地址",id:"searchUrl",type:"String",hint:"[域名可省略]/search.php@kw={{key}}"},{title:"校验文字",namespace:"ruleSearch",id:"checkKeyWord",type:"String",hint:"校验关键字"},{title:"列表规则",namespace:"ruleSearch",id:"bookList",type:"String",hint:"选择书籍节点 (规则结果为List<Element>)"},{title:"书名规则",namespace:"ruleSearch",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleSearch",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleSearch",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleSearch",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleSearch",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleSearch",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleSearch",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"详情地址",namespace:"ruleSearch",id:"bookUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url)"}]},find:{name:"发现",children:[{title:"发现地址",id:"exploreUrl",type:"String",hint:`内容能显示在发现菜单
每行一条发现分类(网址域名可省略)，例：
名称1::网址(Url)1
名称2::网址(Url)2
...`},{title:"发现筛选",id:"exploreScreen",type:"String",hint:"发现筛选规则"},{title:"列表规则",namespace:"ruleExplore",id:"bookList",type:"String",hint:"选择书籍节点 (规则结果为List<Element>)"},{title:"书名规则",namespace:"ruleExplore",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleExplore",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleExplore",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleExplore",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleExplore",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleExplore",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleExplore",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"详情地址",namespace:"ruleExplore",id:"bookUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url)"}]},detail:{name:"详情",children:[{title:"预处理",namespace:"ruleBookInfo",id:"init",type:"String",hint:"用于加速详情信息检索，只支持AllInOne规则"},{title:"书名规则",namespace:"ruleBookInfo",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleBookInfo",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleBookInfo",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleBookInfo",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleBookInfo",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleBookInfo",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleBookInfo",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"目录地址",namespace:"ruleBookInfo",id:"tocUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url, 与详情页相同时可省略)"},{title:"下载URL",namespace:"ruleBookInfo",id:"downloadUrls",type:"String",hint:"文件类书源下载地址 (规则结果为String类型的url, 多个链接返回数组)"},{title:"修改书籍",namespace:"ruleBookInfo",id:"canReName",type:"String",hint:"允许修改书名作者(规则结果为String类型, 默认不允许)"}]},directory:{name:"目录",children:[{title:"预处理",namespace:"ruleToc",id:"preUpdateJs",type:"String",hint:"更新目录前调用JS 动态更新目录链接"},{title:"列表规则",namespace:"ruleToc",id:"chapterList",type:"String",hint:"选择目录列表的章节节点 (规则结果为List<Element>)"},{title:"章节名称",namespace:"ruleToc",id:"chapterName",type:"String",hint:"选择章节名称 (规则结果为String)"},{title:"章节地址",namespace:"ruleToc",id:"chapterUrl",type:"String",hint:"选择章节链接 (规则结果为String类型的Url)"},{title:"卷名标识",namespace:"ruleToc",id:"isVolume",type:"String",hint:"章节名称是否是卷名 (规则结果为Bool)"},{title:"收费标识",namespace:"ruleToc",id:"isVip",type:"String",hint:"章节是否为VIP章节 (规则结果为Bool)"},{title:"购买标识",namespace:"ruleToc",id:"isPay",type:"String",hint:"章节是否为已购买 (规则结果为Bool)"},{title:"章节信息",namespace:"ruleToc",id:"updateTime",type:"String",hint:"选择章节信息 (规则结果为String)"},{title:"翻页规则",namespace:"ruleToc",id:"nextTocUrl",type:"String",hint:"选择目录下一页链接 (规则结果为List<String>或String)"}]},content:{name:"正文",children:[{title:"脚本注入",namespace:"ruleContent",id:"webJs",type:"String",hint:"注入javascript，用于模拟鼠标点击等，必须有返回值，一般为String类型"},{title:"正文规则",namespace:"ruleContent",id:"content",type:"String",hint:"选择正文内容 (规则结果为String)"},{title:"翻页规则",namespace:"ruleContent",id:"nextContentUrl",type:"String",hint:"选择下一分页(不是下一章)链接 (规则结果为String类型的Url)"},{title:"资源正则",namespace:"ruleContent",id:"sourceRegex",type:"String",hint:"匹配资源的url特征，用于嗅探"},{title:"替换规则",namespace:"ruleContent",id:"replaceRegex",type:"String",hint:"多页内容合并后替换，用于正文净化"},{title:"图片样式",namespace:"ruleContent",id:"imageStyle",type:"String",hint:"FULL:铺满 不填:默认样式"},{title:"购买操作",namespace:"ruleContent",id:"payAction",type:"String",hint:"填写JavaScript 返回购买链接或者调用购买接口"},{title:"图片解密",namespace:"ruleContent",id:"imageDecode",type:"String",hint:"填写JavaScript 返回解密图片的bytes "}]},other:{name:"其他",children:[{title:"启用搜索",id:"enabled",type:"Boolean"},{title:"启用发现",id:"enabledExplore",type:"Boolean"},{title:"启用段评",id:"enabledReview",type:"Boolean"},{title:"Cookie",id:"enabledCookieJar",type:"Boolean"},{title:"搜索权重",id:"weight",type:"Number"},{title:"排序编号",id:"customOrder",type:"Number"}]}},oo={base:{name:"基础",children:[{title:"源域名",id:"sourceUrl",type:"String",hint:"通常填写网站主页,例: https://www.qidian.com",required:!0},{title:"图标",id:"sourceIcon",type:"String",hint:"填写图片网络链接"},{title:"源名称",id:"sourceName",type:"String",hint:"会显示在源列表",required:!0},{title:"源分组",id:"sourceGroup",type:"String",hint:"描述源的特征信息"},{title:"源注释",id:"sourceComment",type:"String",hint:"描述源作者和状态"},{title:"分类地址",id:"sortUrl",type:"String",hint:`名称1::链接1
名称2::链接2`},{title:"登录地址",id:"loginUrl",type:"String",hint:"填写网站登录网址,仅在需要登录的源有用"},{title:"登录界面",id:"loginUi",type:"String",hint:"自定义登录界面"},{title:"登录检测",id:"loginCheckJs",type:"String",hint:"登录检测js"},{title:"封面解密",id:"coverDecodeJs",type:"String",hint:"封面解密js"},{title:"请求头",id:"header",type:"String",hint:"客户端标识"},{title:"变量说明",id:"variableComment",type:"String",hint:"源变量说明"},{title:"并发率",id:"concurrentRate",type:"String",hint:"并发率"}]},list:{name:"列表",children:[{title:"列表规则",id:"ruleArticles",type:"String",hint:"规则结果为List<Element>"},{title:"翻页规则",id:"ruleNextPage",type:"String",hint:"下一页链接 规则结果为List<String>或String"},{title:"标题规则",id:"ruleTitle",type:"String",hint:"文章标题 规则结果为String"},{title:"时间规则",id:"rulePubDate",type:"String",hint:"文章发布时间 规则结果为String"},{title:"描述规则",id:"ruleDescription",type:"String",hint:"文章简要描述 规则结果为String"},{title:"图片规则",id:"ruleImage",type:"String",hint:"文章图片链接 规则结果为String"},{title:"链接规则",id:"ruleLink",type:"String",hint:"文章链接 规则结果为String"}]},webView:{name:"WebView",children:[{title:"内容规则",id:"ruleContent",type:"String",hint:"文章正文"},{title:"样式规则",id:"style",type:"String",hint:"文章正文样式 填写css"},{title:"注入规则",id:"injectJs",type:"String",hint:"注入网页的JavaScript"},{title:"黑名单",id:"contentBlacklist",type:"String",hint:"webView链接加载黑名单，英文逗号隔开"},{title:"白名单",id:"contentWhitelist",type:"String",hint:"webView链接加载白名单，英文逗号隔开"}]},other:{name:"其他",children:[{title:"列表样式",id:"articleStyle",type:"Array",array:["默认","大图","双列"]},{title:"加载地址",id:"loadWithBaseUrl",type:"Boolean"},{title:"启用JS",id:"enableJs",type:"Boolean"},{title:"启用",id:"enabled",type:"Boolean"},{title:"Cookie",id:"enabledCookieJar",type:"Boolean"},{title:"单URL",id:"singleUrl",type:"Boolean"},{title:"排序编号",id:"customOrder",type:"Number"}]}};const no={class:"editor"},ro={__name:"SourceEditor",setup(e){const t=R({});return/bookSource/i.test(location.href)?(t.value=to,document.title="书源管理"):(t.value=oo,document.title="订阅源管理"),(n,s)=>{const o=eo,r=Yt,p=Kt;return l(),v("div",no,[h(o,{class:"left",config:i(t)},null,8,["config"]),h(r),h(p,{class:"right"})])}}},ce=H(ro,[["__scopeId","data-v-5171d5d6"]]),ke=[{path:"/bookSource",name:"book-home",component:ce},{path:"/rssSource",name:"rss-home",component:ce}];oe({history:ne(),routes:ke});const ve=oe({history:ne(),routes:Se.concat(ke)});ve.afterEach(e=>{e.name=="shelf"&&(document.title="书架")});ze(Xe).use(Jt).use(ve).mount("#app");te(()=>import("./config-251081d9.js"),["./config-251081d9.js","./vendor-ea0dcfac.js","./vendor-a24e7142.css","./config-811f2a0b.css"],import.meta.url);export{j as A,H as _,io as u};
