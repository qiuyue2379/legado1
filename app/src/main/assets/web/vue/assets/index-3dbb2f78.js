import{r as xe,o as l,c as C,a as ne,b as re,d as E,e as p,w as u,f as y,u as i,l as z,g,F as R,E as Be,h as ue,p as Ue,i as Ee,j as Ve,k as x,m as de,s as X,n as F,t as Q,q as pe,v as he,x as se,y as Ie,z as O,A as M,B as ge,C as Ne,D as Te,G as ie,V as $e,H as Y,I as Le,J as _e,K as Re,L as T,M as Oe,N as Pe,O as K,P as me,Q as Se,R as q,S as De,T as Je,U as Ae,W as Ke,X as je,Y as Me,Z as He,_ as Fe,$ as ze,a0 as qe}from"./vendor-0c9d4c13.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const We="modulepreload",Ge=function(e,t){return new URL(e,t).href},le={},oe=function(t,o,s){if(!o||o.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(o.map(r=>{if(r=Ge(r,s),r in le)return;le[r]=!0;const a=r.endsWith(".css"),f=a?'[rel="stylesheet"]':"";if(!!s)for(let S=n.length-1;S>=0;S--){const w=n[S];if(w.href===r&&(!a||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${f}`))return;const _=document.createElement("link");if(_.rel=a?"stylesheet":We,a||(_.as="script",_.crossOrigin=""),_.href=r,document.head.appendChild(_),a)return new Promise((S,w)=>{_.addEventListener("load",S),_.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},P=(e,t)=>{const o=e.__vccOpts||e;for(const[s,n]of t)o[s]=n;return o},Qe={};function Xe(e,t){const o=xe("router-view");return l(),C(o)}const Ye=P(Qe,[["render",Xe]]),ye=[{path:"/",name:"shelf",component:()=>oe(()=>import("./BookShelf-dabb2b6c.js"),["./BookShelf-dabb2b6c.js","./vendor-0c9d4c13.js","./vendor-6f0d1692.css","./loading-ddccb8e8.js","./loading-c009631e.css","./BookShelf-fdcf8eba.css"],import.meta.url)},{path:"/chapter",name:"chapter",component:()=>oe(()=>import("./BookChapter-1722c488.js"),["./BookChapter-1722c488.js","./vendor-0c9d4c13.js","./vendor-6f0d1692.css","./loading-ddccb8e8.js","./loading-c009631e.css","./BookChapter-0adbc371.css"],import.meta.url)}];ne({history:re(),routes:ye});const $=e=>(Ue("data-v-aee57c78"),e=e(),Ee(),e),Ze=$(()=>g("br",null,null,-1)),et=$(()=>g("br",null,null,-1)),tt=$(()=>g("br",null,null,-1)),ot=$(()=>g("br",null,null,-1)),nt=$(()=>g("br",null,null,-1)),rt={style:{"margin-top":"20px"}},st=$(()=>g("code",null,"^$()[]{}.?+*|",-1)),it=$(()=>g("br",null,null,-1)),lt=$(()=>g("code",null,"(?s)",-1)),at=$(()=>g("br",null,null,-1)),ct=$(()=>g("code",null,"(?m)",-1)),ut=$(()=>g("br",null,null,-1)),dt=$(()=>g("code",null,"(?i)",-1)),pt=$(()=>g("br",null,null,-1)),ht={__name:"SourceHelp",setup(e){return(t,o)=>{const s=Be,n=ue;return l(),E(R,null,[p(s,{icon:i(z),href:"https://alanskycn.gitee.io/teachme/",target:"_blank"},{default:u(()=>[y("书源制作教程")]),_:1},8,["icon"]),Ze,p(s,{icon:i(z),href:"https://zhuanlan.zhihu.com/p/29436838",target:"_blank"},{default:u(()=>[y("xpath基础教程")]),_:1},8,["icon"]),et,p(s,{icon:i(z),href:"https://zhuanlan.zhihu.com/p/32187820",target:"_blank"},{default:u(()=>[y("xpath高级教程")]),_:1},8,["icon"]),tt,p(s,{icon:i(z),href:"https://www.w3cschool.cn/regex_rmjc",target:"_blank"},{default:u(()=>[y("正则表达式教程")]),_:1},8,["icon"]),ot,p(s,{icon:i(z),href:"https://regexr-cn.com/",target:"_blank"},{default:u(()=>[y("正则表达式在线验证工具")]),_:1},8,["icon"]),nt,g("div",rt,[g("span",null,[p(n,null,{default:u(()=>[st,y(" 这些是Java正则特殊符号,匹配需转义")]),_:1})]),it,g("span",null,[p(n,null,{default:u(()=>[lt,y(" 前缀表示跨行解析")]),_:1})]),at,g("span",null,[p(n,null,{default:u(()=>[ct,y(" 前缀表示逐行匹配")]),_:1})]),ut,g("span",null,[p(n,null,{default:u(()=>[dt,y(" 前缀表示忽略大小写")]),_:1})]),pt])],64)}}},gt=P(ht,[["__scopeId","data-v-aee57c78"]]),_t=1e3,V=Ve.create({baseURL:location.origin,timeout:120*_t}),{hostname:fe,port:be}=new URL(location.origin),mt=/source/i.test(location.href),St=e=>{throw mt&&x({message:"后端错误，检查网络或者阅读app",type:"error"}),e};V.interceptors.response.use(e=>e,St);const yt=()=>V.get("/getReadConfig"),ft=e=>V.post("/saveReadConfig",e),bt=e=>V.post("/saveBookProgress",e),kt=e=>{e&&navigator.sendBeacon(`${location.origin}/saveBookProgress`,JSON.stringify(e))},vt=()=>V.get("/getBookshelf"),Ct=e=>V.get("/getChapterList?url="+encodeURIComponent(e)),wt=(e,t)=>V.get("/getBookContent?url="+encodeURIComponent(e)+"&index="+t),xt=(e,t,o)=>{const s=`ws://${fe}:${Number(be)+1}/searchBook`,n=new WebSocket(s);n.onopen=()=>{n.send(`{"key":"${e}"}`)},n.onmessage=({data:r})=>t(r),n.onclose=()=>{o()}},Bt=e=>V.post("/saveBook",e),Ut=e=>V.post("/deleteBook",e),G=/bookSource/i.test(location.href),Et=()=>G?V.get("getBookSources"):V.get("getRssSources"),Vt=e=>G?V.post("saveBookSource",e):V.post("saveRssSource",e),It=e=>G?V.post("saveBookSources",e):V.post("saveRssSources",e),Nt=e=>G?V.post("deleteBookSources",e):V.post("deleteRssSources",e),Tt=(e,t,o,s)=>{const n=`ws://${fe}:${Number(be)+1}/${G?"bookSource":"rssSource"}Debug`,r=new WebSocket(n);r.onopen=()=>{r.send(JSON.stringify({tag:e,key:t}))},r.onmessage=({data:a})=>o(a),r.onclose=()=>{x({message:"调试已关闭！",type:"info"}),s()}},j={getReadConfig:yt,saveReadConfig:ft,saveBookProgress:bt,saveBookProgressWithBeacon:kt,getBookShelf:vt,getChapterList:Ct,getBookContent:wt,search:xt,saveBook:Bt,deleteBook:Ut,getSources:Et,saveSources:It,saveSource:Vt,deleteSource:Nt,debug:Tt},W=e=>e==null||e.length===0||/^\s+$/.test(e),ke=e=>"bookSourceName"in e,$t=e=>ke(e)?!W(e.bookSourceName)&&!W(e.bookSourceUrl)&&!W(e.bookSourceType):!W(e.sourceName)&&!W(e.sourceName),Lt=(e,t)=>{var o,s,n,r,a,f,b,_;return ke(e)?(((o=e.bookSourceName)==null?void 0:o.includes(t))||((s=e.bookSourceUrl)==null?void 0:s.includes(t))||((n=e.bookSourceGroup)==null?void 0:n.includes(t))||((r=e.bookSourceComment)==null?void 0:r.includes(t)))??!1:(((a=e.sourceName)==null?void 0:a.includes(t))||((f=e.sourceUrl)==null?void 0:f.includes(t))||((b=e.sourceGroup)==null?void 0:b.includes(t))||((_=e.sourceComment)==null?void 0:_.includes(t)))??!1},Rt={ruleSearch:{},ruleBookInfo:{},ruleToc:{},ruleContent:{},ruleReview:{},ruleExplore:{}},Ot={},A=/bookSource/i.test(location.href),ae=A?Rt:Ot,H=de("source",{state:()=>({bookSources:[],rssSources:[],savedSources:[],currentSource:ae,currentTab:localStorage.getItem("tabName")||"editTab",editTabSource:{},isDebuging:!1}),getters:{sources:e=>A?e.bookSources:e.rssSources,sourceUrlKey:()=>A?"bookSourceUrl":"sourceUrl",sourcesMap:e=>{let t=new Map;return e.sources.forEach(o=>t.set(o[e.sourceUrlKey],o)),t},savedSourcesMap:e=>{let t=new Map;return e.savedSources.forEach(o=>t.set(o[e.sourceUrlKey],o)),t},currentSourceUrl:e=>A?e.currentSource.bookSourceUrl:e.currentSource.sourceUrl,searchKey:e=>A?e.currentSource.ruleSearch.checkKeyWord||"我的":null},actions:{startDebug(){this.currentTab="editDebug",this.isDebuging=!0},debugFinish(){this.isDebuging=!1},saveSources(e){A?this.bookSources=e:this.rssSources=e},setPushReturnSources(e){this.savedSources=e},deleteSources(e){let t=A?this.bookSources:this.rssSources;e.forEach(o=>{let s=t.indexOf(o);s>-1&&t.splice(s,1)})},saveCurrentSource(){let e=this.currentSource,t=this.sourcesMap;t.set(e[this.sourceUrlKey],e),this.saveSources(Array.from(t.values()))},changeCurrentSource(e){this.currentSource=JSON.parse(JSON.stringify(e))},changeTabName(e){this.currentTab=e,localStorage.setItem("tabName",e)},changeEditTabSource(e){this.editTabSource=JSON.parse(JSON.stringify(e))},editHistory(e){let t;if(localStorage.getItem("history"))t=JSON.parse(localStorage.getItem("history")),t.new.push(e),t.new.length>50&&t.new.shift(),t.old.length>50&&t.old.shift(),localStorage.setItem("history",JSON.stringify(t));else{const o={new:[e],old:[]};localStorage.setItem("history",JSON.stringify(o))}},editHistoryUndo(){if(localStorage.getItem("history")){let e=JSON.parse(localStorage.getItem("history"));e.old.push(this.currentSource),e.new.length&&(this.currentSource=e.new.pop()),localStorage.setItem("history",JSON.stringify(e))}},clearAllHistory(){localStorage.setItem("history",JSON.stringify({new:[],old:[]}))},clearEdit(){this.editTabSource={},this.currentSource=ae},clearAllSource(){this.bookSources=[],this.rssSources=[],this.savedSources=[]}}});const Pt={__name:"SourceItem",props:["source"],setup(e){const t=e,o=H(),{savedSourcesMap:s,currentSourceUrl:n,sourceUrlKey:r}=X(o),a=F(()=>t.source[r.value]),f=_=>{o.changeCurrentSource(_)},b=F(()=>s.value.size==0?!1:!s.value.has(a.value));return(_,S)=>{const w=se,v=Ie;return l(),C(v,{size:"large",border:"",label:i(a),class:he({error:i(b),edit:i(a)==i(n)})},{default:u(()=>[y(Q(e.source.bookSourceName||e.source.sourceName)+" ",1),p(w,{text:"",icon:i(pe),onClick:S[0]||(S[0]=c=>f(e.source))},null,8,["icon"])]),_:1},8,["label","class"])}}},Dt=P(Pt,[["__scopeId","data-v-894f04fc"]]);const Jt={class:"tool"},At={__name:"SourceList",setup(e){const t=H(),o=O([]),s=O(""),{sources:n,sourcesMap:r}=X(t),a=F(()=>/bookSource/.test(window.location.href)),f=F(()=>o.value.length==0?[]:o.value.map(c=>r.value.get(c)??{})),b=()=>{j.deleteSource(f.value).then(({data:c})=>{if(!c.isSuccess)return x.error(c.errorMsg);t.deleteSources(f.value),o.value=[]})},_=()=>{t.clearAllSource(),o.value=[]},S=F(()=>{let c=s.value;return c===""?n.value:n.value.filter(U=>Lt(U,c))}),w=()=>{const c=document.createElement("input");c.type="file",c.accept=".json,.txt",c.addEventListener("change",U=>{const D=U.target.files[0];var B=new FileReader;B.readAsText(D),B.onload=()=>{try{const J=JSON.parse(B.result);t.saveSources(J)}catch{x({message:"上传的源格式错误",type:"error"})}}}),c.click()},v=()=>{const c=document.createElement("a");let U=o.value.length===0?S.value:f.value,D=a.value?"BookSource":"RssSource";c.download=`${D}_${Date().replace(/.*?\s(\d+)\s(\d+)\s(\d+:\d+:\d+).*/,"$2$1$3").replace(/:/g,"")}.json`;let B=new Blob([JSON.stringify(U,null,4)],{type:"application/json"});c.href=window.URL.createObjectURL(B),c.click()};return(c,U)=>{const D=Y,B=se,J=Le;return l(),E(R,null,[p(D,{modelValue:i(s),"onUpdate:modelValue":U[0]||(U[0]=I=>M(s)?s.value=I:null),class:"search","prefix-icon":i(ge),placeholder:"筛选源"},null,8,["modelValue","prefix-icon"]),g("div",Jt,[p(B,{onClick:w,icon:i(Ne)},{default:u(()=>[y("打开")]),_:1},8,["icon"]),p(B,{disabled:i(S).length===0,onClick:v,icon:i(Te)},{default:u(()=>[y(" 导出")]),_:1},8,["disabled","icon"]),p(B,{type:"danger",icon:i(ie),onClick:b,disabled:i(o).length===0},{default:u(()=>[y("删除")]),_:1},8,["icon","disabled"]),p(B,{type:"danger",icon:i(ie),onClick:_,disabled:i(n).length===0},{default:u(()=>[y("清空")]),_:1},8,["icon","disabled"])]),p(J,{id:"source-list",modelValue:i(o),"onUpdate:modelValue":U[1]||(U[1]=I=>M(o)?o.value=I:null)},{default:u(()=>[p(i($e),{style:{height:"100%","overflow-y":"auto","overflow-x":"hidden"},"data-key":I=>I.bookSourceUrl||I.sourceUrl,"data-sources":i(S),"data-component":Dt,"estimate-size":45},null,8,["data-key","data-sources"])]),_:1},8,["modelValue"])],64)}}},Kt=P(At,[["__scopeId","data-v-1e35aca9"]]);const jt={__name:"SourceDebug",setup(e){const t=H(),o=O(""),s=O("");_e(()=>t.isDebuging,()=>{t.isDebuging&&r()});const n=f=>{let b=document.querySelector("#debug-text");b.scrollTop=b.scrollHeight,o.value+=f+`
`},r=async()=>{o.value="",await j.saveSource(t.currentSource),j.debug(t.currentSourceUrl,s.value||t.searchKey,n,t.debugFinish)},a=F(()=>/bookSource/.test(window.location.href));return(f,b)=>{const _=Y;return l(),E(R,null,[i(a)?(l(),C(_,{key:0,id:"debug-key",modelValue:i(s),"onUpdate:modelValue":b[0]||(b[0]=S=>M(s)?s.value=S:null),placeholder:"搜索书名、作者","prefix-icon":i(ge),style:{"padding-bottom":"4px"},onKeydown:Re(r,["enter"])},null,8,["modelValue","prefix-icon","onKeydown"])):T("",!0),p(_,{id:"debug-text",modelValue:i(o),"onUpdate:modelValue":b[1]||(b[1]=S=>M(o)?o.value=S:null),type:"textarea",readonly:"",rows:"29",placeholder:"这里用于输出调试信息"},null,8,["modelValue"])],64)}}},Mt=P(jt,[["__scopeId","data-v-eb736730"]]),go=de("book",{state:()=>({connectStatus:"正在连接后端服务器……",connectType:"",newConnect:!0,searchBooks:[],shelf:[],catalog:[],readingBook:{index:0,chapterPos:0},popCataVisible:!1,contentLoading:!0,showContent:!1,config:{theme:0,font:0,fontSize:18,readWidth:800,infiniteLoading:!1,customFontName:"",spacing:{paragraph:1,line:.8,letter:0}},miniInterface:!1,readSettingsVisible:!1}),getters:{bookProgress:e=>{var a;if(e.catalog.length==0)return;const{index:t,chapterPos:o,bookName:s,bookAuthor:n}=e.readingBook;let r=(a=e.catalog[t])==null?void 0:a.title;if(r)return{name:s,author:n,durChapterIndex:t,durChapterPos:o,durChapterTime:new Date().getTime(),durChapterTitle:r}}},actions:{setConnectStatus(e){this.connectStatus=e},setConnectType(e){this.connectType=e},setNewConnect(e){this.newConnect=e},addBooks(e){this.shelf=e},setCatalog(e){this.catalog=e},setPopCataVisible(e){this.popCataVisible=e},setContentLoading(e){this.contentLoading=e},setReadingBook(e){this.readingBook=e},setConfig(e){Object.assign(this.config,e)},setReadSettingsVisible(e){this.readSettingsVisible=e},setShowContent(e){this.showContent=e},setMiniInterface(e){this.miniInterface=e},async setSearchBooks(e){e.forEach(t=>{this.shelf.find(s=>s.bookUrl==t.bookUrl)===void 0&&this.searchBooks.push(t)})},clearSearchBooks(){this.searchBooks=[]},async saveBookProgress(){return this.bookProgress?j.saveBookProgress(this.bookProgress):Promise.resolve()}}}),Ht=Oe();const Ft={__name:"SourceJson",setup(e){const t=H(),o=O(""),s=async n=>{try{t.changeEditTabSource(JSON.parse(n))}catch{x({message:"粘贴的源格式错误",type:"error"})}};return Pe(async()=>{let n=t.editTabSource;Object.keys(n).length>0?o.value=JSON.stringify(n,null,4):o.value=""}),(n,r)=>{const a=Y;return l(),C(a,{id:"source-json",modelValue:i(o),"onUpdate:modelValue":r[0]||(r[0]=f=>M(o)?o.value=f:null),type:"textarea",placeholder:"这里输出序列化的JSON数据,可直接导入'阅读'APP",rows:"30",onChange:s,style:{"margin-bottom":"4px"}},null,8,["modelValue"])}}},zt=P(Ft,[["__scopeId","data-v-7e91a802"]]);const qt={__name:"SourceTabTools",setup(e){const t=H(),{currentTab:o}=X(t),s=O([["editTab","编辑源"],["editDebug","调试源"],["editList","源列表"],["editHelp","帮助信息"]]);return(n,r)=>{const a=zt,f=Mt,b=Kt,_=gt,S=me,w=Se;return l(),C(w,{modelValue:i(o),"onUpdate:modelValue":r[0]||(r[0]=v=>M(o)?o.value=v:null)},{default:u(()=>[(l(!0),E(R,null,K(i(s),(v,c)=>(l(),C(S,{key:v[0],name:v[0],label:v[1]},{default:u(()=>[c==0?(l(),C(a,{key:0})):T("",!0),c==1?(l(),C(f,{key:1})):T("",!0),c==2?(l(),C(b,{key:2})):T("",!0),c==3?(l(),C(_,{key:3})):T("",!0)]),_:2},1032,["name","label"]))),128))]),_:1},8,["modelValue"])}}},Wt=P(qt,[["__scopeId","data-v-dcce2457"]]);const Gt={class:"menu flex-column-center"},Qt={class:"hotkeys-header flex-space-between"},Xt=["id"],Yt={key:0},Zt={class:"hotkeys-settings flex-column-center"},eo={class:"title"},to={class:"hotkeys-item__content"},oo={key:0},no={key:0},ro={__name:"ToolBar",setup(e){const t=H(),o=()=>{const h=x({message:"加载中……",showClose:!0,duration:0});j.getSources().then(({data:d})=>{d.isSuccess?(t.changeTabName("editList"),t.saveSources(d.data),x({message:`成功拉取${d.data.length}条源`,type:"success"})):x({message:d.errorMsg??"后端错误",type:"error"})}).finally(()=>h.close())},s=()=>{let h=t.sources;if(t.changeTabName("editList"),h.length===0)return x({message:"空空如也",type:"info"});x({message:"正在推送中",type:"info"}),j.saveSources(h).then(({data:d})=>{if(d.isSuccess){let m=d.data;if(Array.isArray(m)){let k="";h.length>m.length&&(k=`
推送失败的源将用红色字体标注!`,t.setPushReturnSources(m)),x({message:`批量推送源到「阅读3.0APP」
共计: ${h.length} 条
成功: ${m.length} 条
失败: ${h.length-m.length} 条${k}`,type:"success"})}}else x({message:`批量推送源失败!
ErrorMsg: ${d.errorMsg}`,type:"error"})})},n=()=>{t.changeTabName("editTab"),t.changeEditTabSource(t.currentSource)},r=()=>{t.changeCurrentSource(t.editTabSource)},a=()=>{t.editHistoryUndo()},f=()=>{t.clearEdit(),x({message:"已清除",type:"success"})},b=()=>{t.clearEdit(),t.clearAllHistory(),x({message:"已清除所有历史记录",type:"success"})},_=()=>{let h=/bookSource/.test(location.href),d=t.currentSource;$t(d)?j.saveSource(d).then(({data:m})=>{m.isSuccess?(x({message:`源《${h?d.bookSourceName:d.sourceName}》已成功保存到「阅读3.0APP」`,type:"success"}),t.saveCurrentSource()):x({message:`源《${h?d.bookSourceName:d.sourceName}》保存失败!
ErrorMsg: ${m.errorMsg}`,type:"error"})}):x({message:"请检查<必填>项是否全部填写",type:"error"})},S=()=>{t.startDebug()},w=O(Array.of({name:"⇈推送源",hotKeys:[],action:s},{name:"⇊拉取源",hotKeys:[],action:o},{name:"⋙生成源",hotKeys:[],action:n},{name:"⋘编辑源",hotKeys:[],action:r},{name:"✗清空表单",hotKeys:[],action:f},{name:"↶撤销操作",hotKeys:[],action:a},{name:"↷重做操作",hotKeys:[],action:b},{name:"⇏调试源",hotKeys:[],action:S},{name:"✓保存源",hotKeys:[],action:_})),v=O(!0),c=O(!1),U=O(-1),D=()=>{c.value||(v.value=!1),c.value=!1};_e(v,h=>{if(!h)return q.unbind("*");q.unbind(),q("*",d=>{d.preventDefault();let m=q.getPressedKeyString();m.length==1&&m[0]=="esc"||c.value&&U.value>-1&&(w.value[U.value].hotKeys=m)})},{immediate:!0});const B=h=>{c.value=!0,x({message:"按ESC键或者点击空白处结束录入",type:"info"}),w.value[h].hotKeys=[],U.value=h},J=()=>{v.value=!1;const h=[];w.value.forEach(({hotKeys:d,action:m})=>{q(d.join("+"),k=>{k.preventDefault(),m.call(null)}),h.push(d)}),I(h)},I=h=>{localStorage.setItem("legado_web_hotkeys",JSON.stringify(h))},L=()=>{try{const h=JSON.parse(localStorage.getItem("legado_web_hotkeys"));if(!Array.isArray(h)||h.length==0)return;w.value.forEach((d,m)=>d.hotKeys=h[m]),v.value=!1,J()}catch{x({message:"快捷键配置错误",type:"error"}),localStorage.removeItem("legado_web_hotkeys")}};return De(()=>{L()}),(h,d)=>{const m=se,k=ue,Z=Ae;return l(),E(R,null,[g("div",Gt,[(l(!0),E(R,null,K(i(w),N=>(l(),C(m,{size:"large",key:N.name,onClick:N.action},{default:u(()=>[y(Q(N.name),1)]),_:2},1032,["onClick"]))),128)),p(m,{size:"large",onClick:d[0]||(d[0]=()=>v.value=!0)},{default:u(()=>[y("快捷键")]),_:1})]),p(Z,{modelValue:i(v),"onUpdate:modelValue":d[1]||(d[1]=N=>M(v)?v.value=N:null),"show-close":!1,"before-close":D},{header:u(({titleClass:N,titleId:ee})=>[g("div",Qt,[g("div",{id:ee,class:he(N)},[y(" 快捷键设置 "),i(c)?(l(),E("span",Yt,[p(k,null,{default:u(()=>[y(" / 录入中 ")]),_:1})])):T("",!0)],10,Xt),p(m,{disabled:i(c),onClick:J,icon:i(Je)},{default:u(()=>[y("保存")]),_:1},8,["disabled","icon"])])]),default:u(()=>[g("div",Zt,[(l(!0),E(R,null,K(i(w),(N,ee)=>(l(),E("div",{key:N.name,class:"hotkeys-item flex-space-between"},[g("span",eo,[p(k,null,{default:u(()=>[y(Q(N.name),1)]),_:2},1024)]),g("div",to,[(l(!0),E(R,null,K(N.hotKeys,(te,we)=>(l(),E("div",{key:te},[g("kbd",null,Q(te),1),we+1<N.hotKeys.length?(l(),E("span",oo,[p(k,null,{default:u(()=>[y("+")]),_:1})])):T("",!0)]))),128)),N.hotKeys.length==0?(l(),E("span",no,"未设置")):T("",!0)]),p(m,{disabled:i(c),text:"",icon:i(pe),onClick:te=>B(ee)},{default:u(()=>[y("编辑")]),_:2},1032,["disabled","icon","onClick"])]))),128))])]),_:1},8,["modelValue"])],64)}}},so=P(ro,[["__scopeId","data-v-e3b61f1f"]]);const io={__name:"SourceTabForm",props:["config"],setup(e){const t=H(),{currentSource:o}=X(t);return(s,n)=>{const r=Y,a=Ke,f=je,b=Me,_=He,S=Fe,w=ze,v=me,c=Se;return l(),C(c,{id:"source-edit"},{default:u(()=>[(l(!0),E(R,null,K(Object.values(e.config),({name:U,children:D})=>(l(),C(v,{label:U,key:U},{default:u(()=>[p(w,{"label-position":"right","label-width":"5em"},{default:u(()=>[(l(!0),E(R,null,K(D,({type:B,title:J,namespace:I,id:L,array:h,hint:d,required:m})=>(l(),C(S,{label:J,key:J,required:m},{default:u(()=>[B=="String"&&typeof I>"u"?(l(),C(r,{key:0,type:"textarea",modelValue:i(o)[L],"onUpdate:modelValue":k=>i(o)[L]=k,placeholder:d,autosize:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):T("",!0),B=="String"&&typeof I<"u"?(l(),C(r,{key:1,type:"textarea",modelValue:i(o)[I][L],"onUpdate:modelValue":k=>i(o)[I][L]=k,placeholder:d,autosize:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):T("",!0),B=="Boolean"?(l(),C(a,{key:2,modelValue:i(o)[L],"onUpdate:modelValue":k=>i(o)[L]=k},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),B=="Number"?(l(),C(f,{key:3,modelValue:i(o)[L],"onUpdate:modelValue":k=>i(o)[L]=k,min:0},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),B=="Array"?(l(),C(_,{key:4,modelValue:i(o)[L],"onUpdate:modelValue":k=>i(o)[L]=k},{default:u(()=>[(l(!0),E(R,null,K(h,(k,Z)=>(l(),C(b,{value:Z,key:k,label:k},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):T("",!0)]),_:2},1032,["label","required"]))),128))]),_:2},1024)]),_:2},1032,["label"]))),128))]),_:1})}}},lo=P(io,[["__scopeId","data-v-2cfb5302"]]),ao={base:{name:"基础",children:[{title:"源类型",id:"bookSourceType",type:"Array",array:["文本","音频","图片","文件"],required:!0},{title:"源域名",id:"bookSourceUrl",type:"String",hint:"通常填写网站主页,例: https://www.qidian.com",required:!0},{title:"源名称",id:"bookSourceName",type:"String",hint:"会显示在源列表",required:!0},{title:"源分组",id:"bookSourceGroup",type:"String",hint:"描述源的特征信息"},{title:"源注释",id:"bookSourceComment",type:"String",hint:"描述源作者和状态"},{title:"书源变量",id:"variableComment",type:"String",hint:"书源变量说明"},{title:"登录地址",id:"loginUrl",type:"String",hint:"填写网站登录网址,仅在需要登录的源有用"},{title:"登录界面",id:"loginUi",type:"String",hint:"自定义登录界面"},{title:"登录检测",id:"loginCheckJs",type:"String",hint:"登录检测js"},{title:"封面解密",id:"coverDecodeJs",type:"String",hint:"封面解密js"},{title:"并发率",id:"concurrentRate",type:"String",hint:"并发率"},{title:"js库",id:"jsLib",type:"String",hint:"js库"},{title:"请求头",id:"header",type:"String",hint:"客户端标识"},{title:"链接验证",id:"bookUrlPattern",type:"String",hint:"当详情页URL与源URL的域名不一致时有效，用于添加网址"}]},search:{name:"搜索",children:[{title:"搜索地址",id:"searchUrl",type:"String",hint:"[域名可省略]/search.php@kw={{key}}"},{title:"校验文字",namespace:"ruleSearch",id:"checkKeyWord",type:"String",hint:"校验关键字"},{title:"列表规则",namespace:"ruleSearch",id:"bookList",type:"String",hint:"选择书籍节点 (规则结果为List<Element>)"},{title:"书名规则",namespace:"ruleSearch",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleSearch",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleSearch",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleSearch",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleSearch",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleSearch",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleSearch",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"详情地址",namespace:"ruleSearch",id:"bookUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url)"}]},find:{name:"发现",children:[{title:"发现地址",id:"exploreUrl",type:"String",hint:`内容能显示在发现菜单
每行一条发现分类(网址域名可省略)，例：
名称1::网址(Url)1
名称2::网址(Url)2
...`},{title:"发现筛选",id:"exploreScreen",type:"String",hint:"发现筛选规则"},{title:"列表规则",namespace:"ruleExplore",id:"bookList",type:"String",hint:"选择书籍节点 (规则结果为List<Element>)"},{title:"书名规则",namespace:"ruleExplore",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleExplore",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleExplore",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleExplore",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleExplore",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleExplore",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleExplore",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"详情地址",namespace:"ruleExplore",id:"bookUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url)"}]},detail:{name:"详情",children:[{title:"预处理",namespace:"ruleBookInfo",id:"init",type:"String",hint:"用于加速详情信息检索，只支持AllInOne规则"},{title:"书名规则",namespace:"ruleBookInfo",id:"name",type:"String",hint:"选择节点书名 (规则结果为String)"},{title:"作者规则",namespace:"ruleBookInfo",id:"author",type:"String",hint:"选择节点作者 (规则结果为String)"},{title:"分类规则",namespace:"ruleBookInfo",id:"kind",type:"String",hint:"选择节点分类信息 (规则结果为String)"},{title:"字数规则",namespace:"ruleBookInfo",id:"wordCount",type:"String",hint:"选择节点字数信息 (规则结果为String)"},{title:"最新章节",namespace:"ruleBookInfo",id:"lastChapter",type:"String",hint:"选择节点最新章节 (规则结果为String)"},{title:"简介规则",namespace:"ruleBookInfo",id:"intro",type:"String",hint:"选择节点书籍简介 (规则结果为String)"},{title:"封面规则",namespace:"ruleBookInfo",id:"coverUrl",type:"String",hint:"选择节点书籍封面 (规则结果为String类型的url)"},{title:"目录地址",namespace:"ruleBookInfo",id:"tocUrl",type:"String",hint:"选择书籍详情页网址 (规则结果为String类型的url, 与详情页相同时可省略)"},{title:"下载URL",namespace:"ruleBookInfo",id:"downloadUrls",type:"String",hint:"文件类书源下载地址 (规则结果为String类型的url, 多个链接返回数组)"},{title:"修改书籍",namespace:"ruleBookInfo",id:"canReName",type:"String",hint:"允许修改书名作者(规则结果为String类型, 默认不允许)"}]},directory:{name:"目录",children:[{title:"预处理",namespace:"ruleToc",id:"preUpdateJs",type:"String",hint:"更新目录前调用JS 动态更新目录链接"},{title:"列表规则",namespace:"ruleToc",id:"chapterList",type:"String",hint:"选择目录列表的章节节点 (规则结果为List<Element>)"},{title:"章节名称",namespace:"ruleToc",id:"chapterName",type:"String",hint:"选择章节名称 (规则结果为String)"},{title:"章节地址",namespace:"ruleToc",id:"chapterUrl",type:"String",hint:"选择章节链接 (规则结果为String类型的Url)"},{title:"卷名标识",namespace:"ruleToc",id:"isVolume",type:"String",hint:"章节名称是否是卷名 (规则结果为Bool)"},{title:"收费标识",namespace:"ruleToc",id:"isVip",type:"String",hint:"章节是否为VIP章节 (规则结果为Bool)"},{title:"购买标识",namespace:"ruleToc",id:"isPay",type:"String",hint:"章节是否为已购买 (规则结果为Bool)"},{title:"章节信息",namespace:"ruleToc",id:"updateTime",type:"String",hint:"选择章节信息 (规则结果为String)"},{title:"翻页规则",namespace:"ruleToc",id:"nextTocUrl",type:"String",hint:"选择目录下一页链接 (规则结果为List<String>或String)"}]},content:{name:"正文",children:[{title:"脚本注入",namespace:"ruleContent",id:"webJs",type:"String",hint:"注入javascript，用于模拟鼠标点击等，必须有返回值，一般为String类型"},{title:"正文规则",namespace:"ruleContent",id:"content",type:"String",hint:"选择正文内容 (规则结果为String)"},{title:"翻页规则",namespace:"ruleContent",id:"nextContentUrl",type:"String",hint:"选择下一分页(不是下一章)链接 (规则结果为String类型的Url)"},{title:"资源正则",namespace:"ruleContent",id:"sourceRegex",type:"String",hint:"匹配资源的url特征，用于嗅探"},{title:"替换规则",namespace:"ruleContent",id:"replaceRegex",type:"String",hint:"多页内容合并后替换，用于正文净化"},{title:"图片样式",namespace:"ruleContent",id:"imageStyle",type:"String",hint:"FULL:铺满 不填:默认样式"},{title:"购买操作",namespace:"ruleContent",id:"payAction",type:"String",hint:"填写JavaScript 返回购买链接或者调用购买接口"},{title:"图片解密",namespace:"ruleContent",id:"imageDecode",type:"String",hint:"填写JavaScript 返回解密图片的bytes "}]},other:{name:"其他",children:[{title:"启用搜索",id:"enabled",type:"Boolean"},{title:"启用发现",id:"enabledExplore",type:"Boolean"},{title:"Cookie",id:"enabledCookieJar",type:"Boolean"},{title:"搜索权重",id:"weight",type:"Number"},{title:"排序编号",id:"customOrder",type:"Number"}]}},co={base:{name:"基础",children:[{title:"源域名",id:"sourceUrl",type:"String",hint:"通常填写网站主页,例: https://www.qidian.com",required:!0},{title:"图标",id:"sourceIcon",type:"String",hint:"填写图片网络链接"},{title:"源名称",id:"sourceName",type:"String",hint:"会显示在源列表",required:!0},{title:"源分组",id:"sourceGroup",type:"String",hint:"描述源的特征信息"},{title:"源注释",id:"sourceComment",type:"String",hint:"描述源作者和状态"},{title:"分类地址",id:"sortUrl",type:"String",hint:`名称1::链接1
名称2::链接2`},{title:"登录地址",id:"loginUrl",type:"String",hint:"填写网站登录网址,仅在需要登录的源有用"},{title:"登录界面",id:"loginUi",type:"String",hint:"自定义登录界面"},{title:"登录检测",id:"loginCheckJs",type:"String",hint:"登录检测js"},{title:"封面解密",id:"coverDecodeJs",type:"String",hint:"封面解密js"},{title:"请求头",id:"header",type:"String",hint:"客户端标识"},{title:"变量说明",id:"variableComment",type:"String",hint:"源变量说明"},{title:"并发率",id:"concurrentRate",type:"String",hint:"并发率"}]},list:{name:"列表",children:[{title:"列表规则",id:"ruleArticles",type:"String",hint:"规则结果为List<Element>"},{title:"翻页规则",id:"ruleNextPage",type:"String",hint:"下一页链接 规则结果为List<String>或String"},{title:"标题规则",id:"ruleTitle",type:"String",hint:"文章标题 规则结果为String"},{title:"时间规则",id:"rulePubDate",type:"String",hint:"文章发布时间 规则结果为String"},{title:"描述规则",id:"ruleDescription",type:"String",hint:"文章简要描述 规则结果为String"},{title:"图片规则",id:"ruleImage",type:"String",hint:"文章图片链接 规则结果为String"},{title:"链接规则",id:"ruleLink",type:"String",hint:"文章链接 规则结果为String"}]},webView:{name:"WebView",children:[{title:"内容规则",id:"ruleContent",type:"String",hint:"文章正文"},{title:"样式规则",id:"style",type:"String",hint:"文章正文样式 填写css"},{title:"注入规则",id:"injectJs",type:"String",hint:"注入网页的JavaScript"},{title:"黑名单",id:"contentBlacklist",type:"String",hint:"webView链接加载黑名单，英文逗号隔开"},{title:"白名单",id:"contentWhitelist",type:"String",hint:"webView链接加载白名单，英文逗号隔开"}]},other:{name:"其他",children:[{title:"列表样式",id:"articleStyle",type:"Array",array:["默认","大图","双列"]},{title:"加载地址",id:"loadWithBaseUrl",type:"Boolean"},{title:"启用JS",id:"enableJs",type:"Boolean"},{title:"启用",id:"enabled",type:"Boolean"},{title:"Cookie",id:"enabledCookieJar",type:"Boolean"},{title:"单URL",id:"singleUrl",type:"Boolean"},{title:"排序编号",id:"customOrder",type:"Number"}]}};const uo={class:"editor"},po={__name:"SourceEditor",setup(e){const t=O({});return/bookSource/i.test(location.href)?(t.value=ao,document.title="书源管理"):(t.value=co,document.title="订阅源管理"),(o,s)=>{const n=lo,r=so,a=Wt;return l(),E("div",uo,[p(n,{class:"left",config:i(t)},null,8,["config"]),p(r),p(a,{class:"right"})])}}},ce=P(po,[["__scopeId","data-v-e99e7704"]]),ve=[{path:"/bookSource",name:"book-home",component:ce},{path:"/rssSource",name:"rss-home",component:ce}];ne({history:re(),routes:ve});const Ce=ne({history:re(),routes:ye.concat(ve)});Ce.afterEach(e=>{e.name=="shelf"&&(document.title="书架")});qe(Ye).use(Ht).use(Ce).mount("#app");oe(()=>import("./config-366f8406.js"),["./config-366f8406.js","./vendor-0c9d4c13.js","./vendor-6f0d1692.css","./config-811f2a0b.css"],import.meta.url);export{j as A,P as _,go as u};
